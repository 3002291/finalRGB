<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
   PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
   "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.douzone.comet.service.eh.ehsevr.dao.Ehsevr00500_DAO">

	<select id="selectList" resultType="com.douzone.comet.service.eh.ehsevr.models.Ehsevr00500">
		SELECT 
			A.COMPANY_CD
			, A.PLANT_CD
			, B.PLANT_NM 
			, A.EQP_CD
			, A.EQP_NM
			, A.WHM_CD
			, A.WHM_NM
			, A.SQ_NO
			, A.RMK_DC
		FROM @{dzparam_dbname}EH_WHM_MST A
		LEFT OUTER JOIN @{dzparam_dbname}MA_PLANT_MST B
		ON A.COMPANY_CD = B.COMPANY_CD 
			AND A.PLANT_CD = B.PLANT_CD 
		WHERE A.COMPANY_CD = #{P_COMPANY_CD}
		<if test='P_PLANT_CD != null and !"".equals(P_PLANT_CD)'>
			AND A.PLANT_CD = #{P_PLANT_CD}
		</if>
		<if test='P_WHM_NM != null and P_WHM_NM != ""'>
		AND (  UPPER(A.P_WHM_NM) 	LIKE '%'||#{P_WHM_NM}||'%' )
		</if>
	</select>
	
	<select id="mstDupCheck" resultType="int">
		SELECT COUNT(1) 
		FROM @{dzparam_dbname}EH_WHM_MST 
		WHERE COMPANY_CD = #{company_cd}
			AND PLANT_CD = #{plant_cd} 
			AND WHM_CD = #{whm_cd} 
	</select>
	
	<delete id="deleteEhsevr00500">	
		DELETE
		FROM	@{dzparam_dbname}EH_WHM_MST
		WHERE COMPANY_CD = #{company_cd}
			AND PLANT_CD = #{plant_cd} 
			AND WHM_CD = #{whm_cd} 
	</delete>
	
	<insert id="insertEhsevr00500">
		INSERT INTO @{dzparam_dbname}EH_WHM_MST (
				COMPANY_CD
				,PLANT_CD
				,EQP_CD
				,EQP_NM
				,WHM_CD
				,WHM_NM
				,SQ_NO
				,RMK_DC
				,INSERT_ID
				,INSERT_IP
				,INSERT_MCADDR_NM
				,INSERT_DTS
		) VALUES (
				#{company_cd}
				, #{plant_cd}
				, #{eqp_cd}
				, #{eqp_nm}
				, #{whm_cd}
				, #{whm_nm}
				, #{sq_no}
				, #{rmk_dc}
				, #{P_INSERT_ID}
				, #{P_INSERT_IP}
				, #{P_INSERT_MCADDR_NM}
				, SYSDATE
		)
	</insert>
	
	
	<update id="updateEhsevr00500">		
		UPDATE	@{dzparam_dbname}EH_WHM_MST
		SET		
 			<if test='eqp_cd neq null'> EQP_CD = #{eqp_cd}, </if>
			<if test='eqp_nm neq null'> EQP_NM = #{eqp_nm}, </if> 
			<if test='whm_nm neq null'> WHM_NM = #{whm_nm}, </if>
			<if test='sq_no neq null'> SQ_NO = #{sq_no}, </if>
			<if test='rmk_dc neq null'> RMK_DC = #{rmk_dc}, </if>
			UPDATE_ID = #{P_UPDATE_ID},
			UPDATE_IP = #{P_UPDATE_IP},
			UPDATE_MCADDR_NM = #{P_UPDATE_MCADDR_NM},
			UPDATE_DTS = SYSDATE
		WHERE COMPANY_CD = #{company_cd}
			AND PLANT_CD = #{plant_cd} 
			AND WHM_CD = #{whm_cd} 
	</update>
	
</mapper>
